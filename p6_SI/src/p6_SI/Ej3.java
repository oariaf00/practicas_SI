package p6_SI;

import java.util.ArrayList;

public class Ej3 {
	

	public void principal() {
	//Datos del problema
	
			char [] alf = {'A','Á','B','C','D','E','É','F','G','H','I','Í','J','K','L','M','N','Ñ','O','Ó','P','Q','R','S','T','U','Ú','V','W','X','Y','Z',' ','.',',',';',':','(',')','¿','?','¡','!','-','0','1','2','3','4','5','6','7','8','9','a','á','b','c','d','e','é','f','g','h','i','í','j','k','l','m','n','ñ','o','ó','p','q','r','s','t','u','ú','v','w','x','y','z'};
			
			int [] lista= {0,0,2,1,2,2,1,2,1,0,2,0,0,2,0,2,2,1,0,2,1,2,1,0,2,0,1,1,2,1,1,0,1,1,1,2,2,0,2,0,0,2,0,1,0,1,2,2,2,1,1,2,0,0,1,1,0,2,0,2,0,2,2,0,1,0,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,2,1,2,1,1,1,0,
					2,2,2,1,2,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,1,2,2,0,1,1,0,0,1,1,0,0,2,1,1,0,2,2,0,0,2,2,0,2,1,0,0,2,2,2,0,1,2,2,2,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,1,2,1,2,2,2,0,
					1,1,1,2,1,0,2,2,0,1,0,1,1,2,2,0,0,2,1,0,0,2,2,2,0,1,2,2,2,2,0,1,1,2,1,1,0,1,1,1,2,2,0,2,0,0,2,0,1,0,1,2,2,2,1,2,1,1,1,0,2,2,2,1,2,0,2,2,0,1,0,1,1,2,2,0,0,2,0,0,2,1,0,2,2,2,1,0,2,2,2,1,0,1,2,1,2,2,0,2,2,1,0,2,2,1,2,2,0,2,2,2,1,2,0,0,2,1,0,2,
					2,2,1,0,2,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,2,2,2,2,0,0,0,1,0,0,2,1,0,2,2,1,2,2,0,2,2,2,1,1,2,1,2,2,2,0,1,1,1,2,1,0,2,1,1,0,2,2,0,0,2,2,0,0,1,1,0,2,0,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,2,1,2,1,0,2,0,0,1,2,2,0,1,1,
					0,0,1,1,0,0,2,2,0,1,0,1,1,2,2,0,0,1,1,0,2,0,2,1,2,0,0,2,1,2,2,1,0,1,2,1,2,2,0,2,2,2,0,2,0,0,2,0,1,0,1,2,2,2,0,0,2,1,0,2,2,2,1,0,2,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,0,1,1,2,1,1,0,1,1,1,2,2,1,0,0,2,2,2,0,1,2,2,2,0,0,2,1,2,2,1,
					2,1,0,2,0,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,2,1,0,1,2,1,2,2,0,2,2,2,0,2,0,0,2,0,1,0,1,2,2,2,2,0,1,0,1,2,1,0,0,1,2,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,1,1,2,0,2,1,2,
					1,1,0,1,1,0,2,0,2,2,1,0,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,2,0,2,0,0,2,0,1,0,1,2,2,0,2,2,0,1,0,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,0,1,2,1,2,2,0,2,2,2,0,2,0,0,2,0,1,0,1,2,2,1,0,1,0,0,1,0,
					2,0,2,1,1,0,2,0,2,2,1,0,2,1,2,1,0,0,2,0,2,2,1,0,2,1,2,1,0,2,1,0,0,2,2,2,0,1,2,2,2,1,0,2,2,1,2,2,0,2,2,2,1,1,1,2,0,2,1,2,1,1,0,1,1,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,0,1,1,2,1,1,0,1,1,1,2,1,0,2,2,1,2,2,0,2,2,2,1,0,0,0,0,0,0,0,
					0,0,0,0,0,0,2,0,2,2,1,0,2,1,2,1,0,1,1,0,2,0,2,1,2,0,0,2,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,1,1,0,2,0,2,2,1,1,0,0,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,1,0,1,1,2,0,
					1,2,1,2,0,0,2,2,0,1,0,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,1,1,1,0,2,2,2,1,2,1,0,1,0,0,1,0,2,0,2,1,1,1,2,1,2,2,2,0,1,1,1,2,1,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,1,0,0,2,2,2,0,1,2,2,2,0,0,0,0,0,0,0,
					0,0,0,0,0,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,2,2,1,0,1,2,1,2,2,0,2,2,1,0,2,2,1,2,2,0,2,2,2,1,2,2,0,1,0,1,2,1,0,0,1,2,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,2,1,0,1,2,1,2,2,0,2,2,1,0,2,2,1,2,2,0,2,2,2,1,2,1,2,1,1,1,0,
					2,2,2,1,2,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,1,2,2,0,1,1,0,0,1,1,0,0,2,1,1,0,2,2,0,0,2,2,0,2,1,0,0,2,2,2,0,1,2,2,2,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,1,1,2,0,2,1,2,
					1,1,0,1,1,0,2,2,0,1,0,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,2,1,0,0,2,2,2,0,1,2,2,2,0,2,2,0,1,0,1,1,2,2,0,0,2,1,0,0,2,2,2,0,1,2,2,2,2,0,1,1,2,1,1,0,1,1,1,2,2,0,1,1,2,1,1,0,1,1,1,2,0,1,2,2,0,1,1,
					0,0,1,1,0,0,2,2,0,1,0,1,1,2,2,0,0,2,1,0,0,2,2,2,0,1,2,2,2,2,1,2,1,1,1,0,2,2,2,1,2,1,0,2,2,1,2,2,0,2,2,2,1,2,0,0,2,1,0,2,2,2,1,0,2,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,1,2,1,1,1,0,2,2,2,1,2,1,0,2,2,1,2,2,0,2,2,2,1,2,0,0,2,1,0,2,
					2,2,1,0,2,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,0,1,1,2,1,1,0,1,1,1,2,2,0,2,0,0,2,0,1,0,1,2,2,2,1,2,1,1,1,0,2,2,2,1,2,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,2,2,2,2,0,0,0,1,0,0,2,0,0,2,1,2,2,1,2,1,0,2,0,2,0,0,2,1,0,2,
					2,2,1,0,2,0,2,0,2,2,1,0,2,1,2,1,0,1,1,0,2,0,2,1,2,0,0,2,1,2,0,0,2,1,0,2,2,2,1,0,2,0,1,0,1,1,2,0,1,2,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,0,2,2,0,0,2,2,0,0,2,0,2,2,1,0,2,1,2,1,0,2,0,0,2,1,0,2,2,2,1,0,2,0,0,1,2,1,1,2,1,2,0,1,0,0,2,0,2,2,1,0,
					2,1,2,1,0,0,1,0,1,1,2,0,1,2,1,2,0,2,0,0,2,1,0,2,2,2,1,0,2,1,0,2,2,1,2,2,0,2,2,2,1,0,0,1,2,1,1,2,1,2,0,1,0,0,1,2,2,0,1,1,0,0,1,1,0,0,1,1,0,2,0,2,2,1,1,0,0,1,0,0,1,2,0,1,1,1,2,0,1,2,2,1,0,1,2,1,2,2,0,2,2,2,0,2,0,0,2,0,1,0,1,2,2,0,0,0,0,0,0,0,
					0,0,0,0,0,0,2,0,2,2,1,0,2,1,2,1,0,0,2,0,2,2,1,0,2,1,2,1,0,2,2,1,0,1,2,1,2,2,0,2,2,1,0,2,2,1,2,2,0,2,2,2,1,0,2,0,2,2,1,0,2,1,2,1,0,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,0,0,2,1,0,2,2,2,1,0,2,0,0,2,1,2,2,1,2,1,0,2,0,2,0,2,0,0,2,0,
					1,0,1,2,2,0,2,2,0,1,0,1,1,2,2,0,0,1,1,0,2,0,2,1,2,0,0,2,1,2,2,0,1,0,1,2,1,0,0,1,2,0,1,0,1,1,2,0,1,2,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,2,0,1,1,2,1,1,0,1,1,1,2,0,0,2,1,2,2,1,2,1,0,2,0,1,0,0,1,2,0,1,
					1,1,2,0,1,0,2,0,2,2,1,0,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,0,1,2,1,2,2,0,2,2,1,0,2,2,1,2,2,0,2,2,2,1,1,1,2,0,2,1,2,1,1,0,1,1,0,2,0,2,2,1,0,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,2,0,2,1,1,2,0,1,1,2,1,1,0,1,1,1,2,0,1,2,2,0,1,1,
					0,0,1,1,0,1,0,0,1,2,0,1,1,1,2,0,1,1,0,0,1,2,0,1,1,1,2,0,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,1,0,0,1,2,0,1,1,1,2,0,1,0,2,0,2,2,1,0,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,1,2,1,1,0,1,1,1,2,0,0,2,1,2,2,1,2,1,0,2,0,0,1,2,2,0,1,1,
					0,0,1,1,0,0,2,2,0,1,0,1,1,2,2,0,0,1,1,0,2,0,2,1,2,0,0,2,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,1,1,0,2,0,2,2,1,1,0,0,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,1,2,0,0,1,1,1,
					0,2,1,1,1,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,1,0,1,0,0,1,0,2,0,2,1,1,2,1,0,0,2,2,2,0,1,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,0,1,1,2,1,1,0,1,1,1,2,1,0,2,2,1,2,2,0,2,2,2,1,0,0,0,0,0,0,0,
					0,0,0,0,0,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,2,2,2,2,0,0,0,1,0,0,2,1,0,2,2,1,2,2,0,2,2,2,1,1,2,1,2,2,2,0,1,1,1,2,1,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,2,1,1,2,0,0,1,1,0,2,0,2,0,0,2,1,2,2,1,2,1,0,2,0,0,0,0,0,0,0,0,
					0,0,0,0,0,0,2,2,0,1,0,1,1,2,2,0,0,1,1,0,2,0,2,1,2,0,0,2,1,2,0,1,1,2,1,1,0,1,1,1,2,1,0,2,2,1,2,2,0,2,2,2,1,1,0,2,2,1,2,2,0,2,2,2,1,0,2,1,1,0,2,2,0,0,2,2,0,2,1,0,0,2,2,2,0,1,2,2,2,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,1,1,0,2,0,2,
					2,1,1,0,0,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,2,1,0,1,2,1,2,2,0,2,2,2,0,2,0,0,2,0,1,0,1,2,2,2,2,0,1,0,1,2,1,0,0,1,2,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,1,2,1,1,1,0,2,2,2,1,2,1,0,2,2,1,2,2,0,2,2,2,1,2,2,0,1,0,1,2,
					1,0,0,1,2,0,2,2,0,1,0,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,0,2,2,0,0,2,2,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,0,1,1,0,2,0,2,
					2,1,1,0,0,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,2,0,0,2,0,1,0,1,2,2,1,2,0,0,1,1,1,0,2,1,1,1,0,2,1,1,0,2,2,0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,2,1,0,1,2,1,2,2,0,2,2,2,0,1,1,2,1,1,0,1,1,1,2,0,1,2,2,0,1,1,
					0,0,1,1,0,0,2,0,2,2,1,0,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,2,1,1,1,0,2,2,2,1,2,1,0,2,2,1,2,2,0,2,2,2,1,0,1,0,1,1,2,0,1,2,1,2,0,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,2,2,1,0,1,2,1,2,2,0,2,2,2,0,2,0,0,2,0,1,0,1,2,2,2,2,0,1,0,1,2,
					1,0,0,1,2,0,2,2,0,1,0,1,1,2,2,0,0,1,1,0,2,0,2,1,2,0,0,2,1,2,2,0,1,0,1,2,1,0,0,1,2,0,0,2,1,2,2,1,2,1,0,2,0,2,1,2,1,1,1,0,2,2,2,1,2,0,1,1,0,2,0,2,2,1,1,0,0,1,1,0,2,0,2,1,2,0,0,2,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,1,1,2,1,1,0,1,1,1,2,0,1,2,2,0,1,1,
					0,0,1,1,0,0,1,1,0,2,0,2,2,1,1,0,0,0,1,0,1,1,2,0,1,2,1,2,0,0,1,1,0,2,0,2,2,1,1,0,0,2,0,0,2,1,0,2,2,2,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,0,0,1,2,1,1,2,1,2,0,1,0,2,0,0,2,1,0,2,2,2,1,0,2,1,1,2,0,2,1,2,
					1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,1,1,1,0,2,1,1,1,0,0,2,1,2,2,1,2,1,0,2,0,2,0,0,2,1,0,2,2,2,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,1,2,1,2,0,1,0,2,1,0,0,2,2,2,0,1,2,2,2,0,0,1,2,1,1,2,1,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,
					2,0,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,2,0,2,1,1,2,0,0,2,1,0,2,2,2,1,0,2,0,1,1,0,2,0,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,1,1,1,0,2,1,1,1,0,1,1,0,2,0,2,2,1,1,0,0,2,0,1,1,2,1,1,0,1,1,1,2,0,1,2,2,0,1,1,
					0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,1,1,1,0,2,1,1,1,0,2,1,1,0,2,2,0,0,2,2,0,1,0,0,1,2,0,1,1,1,2,0,1,1,0,1,0,0,1,0,2,0,2,1,1,0,1,0,1,1,2,0,1,2,1,2,0,1,1,0,2,0,2,1,2,0,0,2,1,0,2,0,2,2,1,0,2,1,2,1,0,0,0,1,2,1,1,2,1,2,0,1,0,0,2,1,1,0,2,2,
					0,0,2,2,0,0,1,0,1,1,2,0,1,2,1,2,0,1,2,0,0,1,1,1,0,2,1,1,1,0,1,2,2,0,1,1,0,0,1,1,0,0,0,2,1,2,2,1,2,1,0,2,0,2,2,1,0,1,2,1,2,2,0,2,2,0,2,2,0,1,0,1,1,2,2,0,0,1,1,0,2,0,2,1,2,0,0,2,1,2,1,0,0,2,2,2,0,1,2,2,2,1,0,2,2,1,2,2,0,2,2,2,1,0,1,2,2,0,1,1,
					0,0,1,1,0,0,2,1,1,0,2,2,0,0,2,2,0,1,2,0,0,1,1,1,0,2,1,1,1,1,0,1,0,0,1,0,2,0,2,1,1,2,0,0,2,1,0,2,2,2,1,0,2,0,0,2,1,2,2,1,2,1,0,2,0,0,2,0,2,2,1,0,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,0,1,2,1,2,2,0,2,2,1,0,2,2,1,2,2,0,2,2,2,1,0,0,2,1,2,2,1,
					2,1,0,2,0,0,2,0,2,2,1,0,2,1,2,1,0,1,2,0,0,1,1,1,0,2,1,1,1,2,2,1,0,1,2,1,2,2,0,2,2,1,1,0,2,0,2,1,2,0,0,2,1,0,1,0,1,1,2,0,1,2,1,2,0,0,1,0,1,1,2,0,1,2,1,2,0,2,1,0,0,2,2,2,0,1,2,2,2,1,0,1,0,0,1,0,2,0,2,1,1,2,0,1,1,2,1,1,0,1,1,1,2,2,0,0,2,1,0,2,
					2,2,1,0,2,0,1,2,2,0,1,1,0,0,1,1,0,2,2,0,1,0,1,2,1,0,0,1,2,1,2,1,2,2,2,0,1,1,1,2,1,2,0,1,1,2,1,1,0,1,1,1,2,2,2,2,2,2,0,0,0,1,0,0,2,0,1,1,0,2,0,2,2,1,1,0,0,0,2};
			
			//Base=3 porque estamos trabajando con un código ternario
			int base = 3;
			
			/*
			 * Calculamos la longitud mínima para codificar cada caracter del alfabeto fuente
			 * y escogemos el valor inmediatamente superior entero como indica la fórmula
			 */
			double logaritmoFuente = Math.log10(alf.length)/Math.log10(base);
			int longitudAlfabeto2 = (int) Math.ceil(logaritmoFuente);
			//System.out.println("Longitud del alfabeto fuente: " + longitudAlfabeto2);
			
			/*
			 * Para saber en cúantos elementos tenemos que dividir el mensaje a decodificar nos fijaremos
			 * en el número de columnas de la matriz generadora G=(I3 | A)
			 * 
			 *				  (1,0,0,0,1,1,1
			 *En este caso G=  0,1,0,0,1,1,0
			 * 				   0,0,1,0,1,0,1
			 * 				   0,0,0,1,0,1,1)
			 * 
			 * 				   (	1,0,0	|	1,2,0,1,1,1,2,0,1	)
			 *En este caso G = (	0,1,0	|	1,1,2,0,1,2,1,2,0	)
			 * 				   (	0,0,1 	|	2,1,1,2,1,2,0,1,0	)
			 * 
			 * Al tener 12 columnas dividimos en grupos de 12 dígitos
			 * 		  
			 */
			
			int i=0;
			int j=0;
			int [] arrayCod = new int [12];
			int [] arrayDecod = new int [3];
			
			ArrayList<Integer> codigoFinal = new ArrayList<Integer>();
			
			/*
			 * Dentro de los conjuntos de 12, debemos diferenciar entre los dígitos para decodificar el mensaje
			 * y el ruido. En este caso como trabajamos con una matriz identidad de dimensiones 3x3 (I), agrupamos
			 * los conjuntos de 3 en 3 números, sobrando así 3 dígitos los cuales forman el denominado ruido
			 */
			
			while(i+12<=lista.length) {//Mientras haya palabras en el código
				for(j=0 ; j<12; j++) {
					if(j<3){
						//Aquí entrará para meter los dígitos en el código final
						arrayDecod[j] = lista[i+j];
						codigoFinal.add(arrayDecod[j]);
					}else {
						//Este será el ruido
						arrayCod[j] = lista[i+j];
					}
				}
				i+=12;
			}
			
			/*
			 * En las siguientes líneas comprobamos que no haya cola dentro del código que nos han dado para
			 * decodificar. De ser así cogemos los dígitos que constituyan la cola y los añadimos al arraylist
			 * con el código final a descifrar
			 */
			
			int mod = lista.length%12;
			
			if(mod>0) {
				int [] cola = new int [mod];
				for(int k=i; k<lista.length; k++){
					cola[k-i] = lista[k];
					codigoFinal.add(cola[k-i]);
				}
			}
			
			/*
			 * En este bucle imprimimos las palabras a descifrar
			 */
			
			//System.out.println("Conjuntos a decodificar: ");
			for(int k=0;k<codigoFinal.size();k++) {
				if(k%3==0&&k!=0) {
					//System.out.println();
				}
				//System.out.print(codigoFinal.get(k));
			}
			
			/*
			 * Como la longitud hallada anteriormente del alfabeto fuente es de 5, dividimos el código a decodificar
			 * en conjuntos de 5 partes
			 */
			
			int tamanioArrayLetras = codigoFinal.size()/longitudAlfabeto2;
			
			i=0;
			j=0;
			int k=0;
			int [] arrayCodigoLetra = new int [longitudAlfabeto2];
			char [] arrayLetras = new char [tamanioArrayLetras];
			
			/*
			 * Repetimos el bucle de antes: Recorremos todo el array con el código y mientras haya conjuntos de 5 elementos
			 * vamos traduciendolo para obtener el mensaje que queremos descifrar
			 */
			//System.out.println();
			
			while(i+longitudAlfabeto2<=codigoFinal.size()) {
				//Con este bucle for conseguimos los 5 elementos para conseguir el símbolo buscado.
				//System.out.println("Código a traducir: ");
				for(j=0 ; j<longitudAlfabeto2; j++) {
					arrayCodigoLetra[j] = codigoFinal.get(i+j);
					//System.out.print(+arrayCodigoLetra[j]);
				}
				//System.out.println();
				//Llamamos al método para traducir la letra y la añadimos a un array
				arrayLetras[k] = traducirLetra(arrayCodigoLetra, alf);
				//System.out.println();
				//System.out.println("LETRA: " + arrayLetras[k]);
				k++;
				
				//System.out.println();
				i = i+longitudAlfabeto2;
			}
			
			ArrayList<Character> texto= new ArrayList<Character>();
			
			
			//Pasamos el array a un arraylist para eliminar los espacios dobles
			for(j=0 ; j<arrayLetras.length; j++) {
				texto.add(arrayLetras[j]);
			}
			
			//Sustituimos los espacios seguidos por saltos de linea
			for(j=0 ; j<texto.size(); j++) {
				if(texto.get(j)==' ' && texto.get(j+1)==' ') {
					texto.set(j, '\n');
					texto.remove(j+1);
				}
			}
			
			
			//Imprimimos el resultado final
			System.out.println("Mensaje decodificado: ");
			for(j=0 ; j<texto.size() ; j++){
				System.out.print(texto.get(j));
			}
			System.out.println();
			
			/*
			//Imprimimos el resultado final
			System.out.println("Mensaje decodificado: ");
			for(int q=0 ; q<arrayLetras.length ; q++){
				System.out.print(arrayLetras[q]);
			}
			System.out.println();
			*/
		}
		
		
		
		public static char traducirLetra(int [] codigoLetra, char [] alf2) {

	        int pos=0;
	        for(int i=0; i<codigoLetra.length; i++) {
	            pos = pos + (codigoLetra[i]*((int) Math.pow(3, codigoLetra.length-(i+1))));
	        }

	        return alf2[pos];
	    }	
	
}
